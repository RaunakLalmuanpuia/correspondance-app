import{Q as K,a as L}from"./QBreadcrumbs-Cc0n6QiA.js";import{r as u,c as $,o as X,w as Z,a as g,b as w,d as t,e as o,f as s,t as n,m as V,i as I,n as p,Q as ee,p as le,q as te,j as ae,k as P,W as se}from"./app-DsiMy1nO.js";import{Q as oe}from"./QSelect-BexRWrLA.js";import{Q as ne,a as f}from"./QTable-Do7_DI4b.js";import{Q as ie}from"./QChip-BUfnKTgb.js";import{a as re,b as j,c as A,Q as de}from"./SFooter.vue_vue_type_style_index_0_scoped_db59b318_lang-B9to8UDw.js";import{Q as b}from"./QField-BHCu9AsH.js";import{_ as ue}from"./BackendLayout-CMp9Dp6j.js";import{d as ce}from"./date-B_LMKYWU.js";import{u as fe}from"./use-quasar-CAprR2Q7.js";const be={class:"flex items-center justify-between q-pa-md bg-white"},me={class:"stitle"},_e={class:"flex q-gutter-sm"},ve={class:"break-words whitespace-normal"},pe={class:"whitespace-pre break-words"},ge={class:"whitespace-pre break-words"},we={class:"stitle"},he={class:"row q-col-gutter-sm",style:{"max-width":"720px"}},ye={class:"col-xs-12"},ke={class:"subtitle whitespace-pre-line"},De={class:"col-xs-12 col-sm-6"},Qe={class:"subtitle whitespace-pre-line"},Ce={class:"col-xs-12 col-sm-6"},Ne={class:"subtitle whitespace-pre-line"},Se={class:"col-xs-12 col-sm-6"},Ve={class:"subtitle"},xe={class:"col-xs-12 col-sm-6"},Me={class:"subtitle"},$e={class:"col-xs-12 col-sm-6"},Ie={class:"subtitle"},je={class:"col-xs-12 col-sm-6"},Ae={class:"subtitle"},We=Object.assign({layout:ue},{__name:"Index",props:["cell","canView","canCreate","canEdit","canDelete"],setup(h){const Y=[{name:"s_no",align:"left",label:"S. No",field:"s_no",sortable:!1},{name:"subject",align:"left",label:"Subject",field:"subject",sortable:!1},{name:"letter_no",align:"left",label:"Letter No",field:"letter_no",sortable:!1},{name:"letter_addressee_main",align:"left",label:"Address(Main)",field:"letter_addressee_main",sortable:!1},{name:"letter_addressee_copy_to",align:"left",label:"Address(Copy to)",field:"letter_addressee_copy_to",sortable:!1},{name:"letter_date",align:"left",label:"Letter Date",field:"letter_date",sortable:!0},{name:"designated_cell",align:"left",label:"Designated Cell",field:"designated_cell",sortable:!1},{name:"issue_date",align:"left",label:"Issue Date",field:"issue_date",sortable:!0},{name:"action",align:"left",label:"Action",field:"action",sortable:!1}],y=fe(),q=u([]),m=u(""),x=u(!1),c=u({sortBy:"desc",descending:!1,page:1,rowsPerPage:10,rowsNumber:0}),k=u(!1),d=u({}),F=a=>{d.value=a,k.value=!0},O=a=>{y.dialog({title:"Confirmation",message:"Do you want to delete?",ok:"Yes",cancel:"No"}).onOk(()=>{se.delete(route("issues.destroy",a.id),{onStart:e=>y.loading.show(),onFinish:e=>y.loading.hide(),preserveState:!1})})},U=a=>{m.value=a,a&&i.value!=="all"&&(i.value="all"),a||(i.value=B.value),D({pagination:c.value,filter:a})};function D(a){const{page:e,rowsPerPage:l,sortBy:r,descending:_}=a.pagination,M=a.filter;x.value=!0,axios.get(route("issues.json-index"),{params:{filter:M,page:e,rowsPerPage:l,month:T.value,year:W.value}}).then(v=>{console.log(v.data);const{list:N}=v.data,{data:S,per_page:z,current_page:G,total:H,to:qe,from:Be}=N;q.value=S,c.value.page=G,c.value.rowsNumber=H,c.value.rowsPerPage=z}).catch(v=>{var N,S;y.notify({type:"negative",message:(S=(N=v==null?void 0:v.response)==null?void 0:N.data)==null?void 0:S.message})}).finally(()=>x.value=!1)}const Q=(a,e)=>{try{return a?ce.formatDate(new Date(a),"DD-MM-YYYY"):"N/A"}catch{return"Invalid Date"}},E=["January","February","March","April","May","June","July","August","September","October","November","December"],C=u([]);function J(){const a=new Date,e=[];e.push({label:"All",value:"all"});for(let l=0;l<12;l++){const r=new Date(a.getFullYear(),a.getMonth()-l,1),_=r.getFullYear(),M=String(r.getMonth()+1).padStart(2,"0");e.push({label:`${E[r.getMonth()]} ${_}`,value:`${_}-${M}`})}C.value=e}const i=u(null),R=$(()=>{if(i.value==="all")return"All";if(!i.value)return"";const[a,e]=i.value.split("-");return new Date(Number(a),Number(e)-1,1).toLocaleString("en-US",{month:"long",year:"numeric"})}),T=$(()=>{var e;if(i.value==="all")return null;const a=((e=i.value)==null?void 0:e.split("-"))||[];return Number(a[1]||null)}),W=$(()=>{var e;if(i.value==="all")return null;const a=((e=i.value)==null?void 0:e.split("-"))||[];return Number(a[0]||null)}),B=u(null);return X(()=>{var a,e;J(),B.value=((a=C.value[1])==null?void 0:a.value)||null,i.value=((e=C.value[1])==null?void 0:e.value)||null,D({pagination:c.value,filter:m.value})}),Z(i,()=>{D({pagination:c.value,filter:m.value})}),(a,e)=>(w(),g(de,{class:"container",padding:""},{default:t(()=>[o("div",be,[o("div",null,[o("div",me,"Issue - "+n(R.value),1),s(K,{class:"text-dark"},{default:t(()=>[s(L,{class:"cursor-pointer",icon:"dashboard",label:"Dashboard",onClick:e[0]||(e[0]=l=>a.$inertia.get(a.route("dashboard")))}),s(L,{class:"cursor-pointer",label:"Issues",onClick:e[1]||(e[1]=l=>a.$inertia.get(a.route("issues.index")))})]),_:1})]),o("div",_e,[h.canCreate?(w(),g(I,{key:0,onClick:e[2]||(e[2]=l=>a.$inertia.get(a.route("issues.create"))),color:"btn-primary",label:"New Issue"})):V("",!0)])]),e[11]||(e[11]=o("br",null,null,-1)),s(ne,{flat:"",ref:"tableRef",rows:q.value,columns:Y,"row-key":"id",pagination:c.value,"onUpdate:pagination":e[5]||(e[5]=l=>c.value=l),loading:x.value,filter:m.value,"binary-state-sort":"","rows-per-page-options":[5,10,15,30,50],onRequest:D},{"top-left":t(()=>[s(oe,{modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=l=>i.value=l),options:C.value,label:"Select Month",outlined:"",dense:"",style:{width:"180px"},"emit-value":"","map-options":""},null,8,["modelValue","options"])]),"top-right":t(()=>[s(ee,{borderless:"",dense:"",debounce:"800","onUpdate:modelValue":[U,e[4]||(e[4]=l=>m.value=l)],"bg-color":"grey-2",outlined:"",modelValue:m.value,clearable:"",placeholder:"Search"},{append:t(()=>[s(le,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-s_no":t(l=>[s(f,null,{default:t(()=>[p(n(l.row.s_no),1)]),_:2},1024)]),"body-cell-subject":t(l=>[s(f,{style:{"min-width":"200px","max-width":"300px"}},{default:t(()=>[o("div",ve,n(l.row.subject),1)]),_:2},1024)]),"body-cell-letter_date":t(l=>[s(f,null,{default:t(()=>[p(n(Q(l.row.letter_date)),1)]),_:2},1024)]),"body-cell-letter_addressee_main":t(l=>[s(f,null,{default:t(()=>[o("div",pe,n(l.row.letter_addressee_main),1)]),_:2},1024)]),"body-cell-letter_addressee_copy_to":t(l=>[s(f,null,{default:t(()=>[o("div",ge,n(l.row.letter_addressee_copy_to),1)]),_:2},1024)]),"body-cell-designated_cell":t(l=>[s(f,null,{default:t(()=>{var r,_;return[s(ie,{label:(_=(r=l.row)==null?void 0:r.cell)==null?void 0:_.name,square:""},null,8,["label"])]}),_:2},1024)]),"body-cell-issue_date":t(l=>[s(f,null,{default:t(()=>[p(n(Q(l.row.issue_date)),1)]),_:2},1024)]),"body-cell-action":t(l=>[s(f,null,{default:t(()=>[s(I,{round:"",icon:"more_vert"},{default:t(()=>[s(re,null,{default:t(()=>[h.canView?(w(),g(j,{key:0,clickable:"",onClick:r=>F(l.row)},{default:t(()=>[s(A,null,{default:t(()=>e[8]||(e[8]=[p("View Detail")])),_:1,__:[8]})]),_:2},1032,["onClick"])):V("",!0),h.canEdit?(w(),g(j,{key:1,clickable:"",onClick:r=>a.$inertia.get(a.route("issues.edit",l.row.id))},{default:t(()=>[s(A,null,{default:t(()=>e[9]||(e[9]=[p("Edit")])),_:1,__:[9]})]),_:2},1032,["onClick"])):V("",!0),h.canDelete?(w(),g(j,{key:2,clickable:"",onClick:r=>O(l.row)},{default:t(()=>[s(A,null,{default:t(()=>e[10]||(e[10]=[p("Delete")])),_:1,__:[10]})]),_:2},1032,["onClick"])):V("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1},8,["rows","pagination","loading","filter"]),s(te,{modelValue:k.value,"onUpdate:modelValue":e[7]||(e[7]=l=>k.value=l),"transition-show":"slide-up","transition-hide":"slide-down"},{default:t(()=>[s(ae,null,{default:t(()=>[s(P,{class:"row items-center justify-between"},{default:t(()=>[o("div",we,"Issue - "+n(d.value.s_no),1),s(I,{dense:"",flat:"",icon:"close",onClick:e[6]||(e[6]=l=>k.value=!1)})]),_:1}),s(P,null,{default:t(()=>[o("div",he,[o("div",ye,[s(b,{label:"Subject",outlined:"","stack-label":"","bg-color":"white"},{default:t(()=>[o("div",ke,n(d.value.subject||"—"),1)]),_:1})]),o("div",De,[s(b,{label:"Letter Addressee (Main)",outlined:"","stack-label":"","bg-color":"white"},{default:t(()=>[o("div",Qe,n(d.value.letter_addressee_main||"—"),1)]),_:1})]),o("div",Ce,[s(b,{label:"Letter Addressee (Copy-to)",outlined:"","stack-label":"","bg-color":"white"},{default:t(()=>[o("div",Ne,n(d.value.letter_addressee_copy_to||"—"),1)]),_:1})]),o("div",Se,[s(b,{label:"Letter No",outlined:"","stack-label":"","bg-color":"white"},{default:t(()=>[o("div",Ve,n(d.value.letter_no||"—"),1)]),_:1})]),o("div",xe,[s(b,{label:"Letter Date",outlined:"","stack-label":"","bg-color":"white"},{default:t(()=>[o("div",Me,n(Q(d.value.letter_date)),1)]),_:1})]),o("div",$e,[s(b,{label:"Designated Cell",outlined:"","stack-label":"","bg-color":"white"},{default:t(()=>{var l,r;return[o("div",Ie,n(((r=(l=d.value)==null?void 0:l.cell)==null?void 0:r.name)||"—"),1)]}),_:1})]),o("div",je,[s(b,{label:"Issue Date",outlined:"","stack-label":"","bg-color":"white"},{default:t(()=>[o("div",Ae,n(Q(d.value.issue_date)||"—"),1)]),_:1})])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1,__:[11]}))}});export{We as default};
