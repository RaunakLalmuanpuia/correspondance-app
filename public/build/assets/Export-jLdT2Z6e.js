import{Q as _,a as f}from"./QBreadcrumbs-CALsSD8D.js";import{Q as k}from"./QSelect-CkXOu_Fc.js";import{r as c,c as m,o as Q,a as S,b as M,d as r,e as n,f as l,j as g,k as p,l as B,i as D}from"./app-WZ1ru_N_.js";import{Q as E}from"./SFooter.vue_vue_type_style_index_0_scoped_db59b318_lang-lV-oJIst.js";import{_ as $}from"./BackendLayout-Bsy9mSmF.js";import{u as q}from"./use-quasar-BfJHp3FQ.js";import"./QField-5LHUvhbi.js";import"./QChip-zJbo8JyV.js";const N={class:"flex items-center justify-between q-pa-md bg-white"},C={class:"q-pa-md"},j={class:"row q-col-gutter-md"},A={class:"row q-gutter-sm col-12 col-sm justify-end"},Y=Object.assign({layout:$},{__name:"Export",props:["office","canImport"],setup(O){const u=q(),v=()=>{u.dialog({title:"Confirm Export",message:"Are you sure you want to export the data?",cancel:!0,persistent:!0}).onOk(()=>{let t={};if(s.value==="all")t.all=1;else if(s.value){const[e,a]=s.value.split("-");t.year=e,t.month=a}axios.get(route("issues.export-issue"),{params:t,responseType:"blob"}).then(e=>{const a=window.URL.createObjectURL(new Blob([e.data])),o=document.createElement("a");o.href=a,o.setAttribute("download",`Issue_${Date.now()}.xlsx`),o.click(),u.notify({type:"positive",message:"Data Successfully Exported"})}).catch(e=>{if(e.response){const a=e.response.data.errors,o=[];if(a){for(const i in a)a[i]&&o.push(...a[i]);u.notify({type:"negative",message:o})}else e.response.data.message&&u.notify({type:"negative",message:e.response.data.message})}else u.notify({type:"negative",message:"System Error. Please try again later."})}).finally(()=>u.loading.hide())})},b=()=>{window.history.back()},y=["January","February","March","April","May","June","July","August","September","October","November","December"],d=c([]);function h(){const t=new Date,e=[];e.push({label:"All",value:"all"});for(let a=0;a<12;a++){const o=new Date(t.getFullYear(),t.getMonth()-a,1),i=o.getFullYear(),x=String(o.getMonth()+1).padStart(2,"0");e.push({label:`${y[o.getMonth()]} ${i}`,value:`${i}-${x}`})}d.value=e}const s=c(null);m(()=>{if(s.value==="all")return"All";if(!s.value)return"";const[t,e]=s.value.split("-");return new Date(Number(t),Number(e)-1,1).toLocaleString("en-US",{month:"long",year:"numeric"})}),m(()=>{var e;if(s.value==="all")return null;const t=((e=s.value)==null?void 0:e.split("-"))||[];return Number(t[1]||null)}),m(()=>{var e;if(s.value==="all")return null;const t=((e=s.value)==null?void 0:e.split("-"))||[];return Number(t[0]||null)});const w=c(null);return Q(()=>{var t,e;h(),w.value=((t=d.value[1])==null?void 0:t.value)||null,s.value=((e=d.value[1])==null?void 0:e.value)||null}),(t,e)=>(M(),S(E,{class:"container",padding:""},{default:r(()=>[n("div",N,[n("div",null,[e[2]||(e[2]=n("div",{class:"stitle"},"Export Issue",-1)),l(_,{class:"text-dark"},{default:r(()=>[l(f,{class:"cursor-pointer",onClick:e[0]||(e[0]=a=>t.$inertia.get(t.route("dashboard"))),icon:"dashboard",label:"Dashboard"}),l(f,{class:"cursor-pointer",label:"Go Back",onClick:b})]),_:1})])]),e[4]||(e[4]=n("br",null,null,-1)),l(g,{flat:""},{default:r(()=>[l(p,null,{default:r(()=>[n("div",C,[l(g,{flat:"",class:"q-mt-md bg-white shadow-1"},{default:r(()=>[l(p,null,{default:r(()=>[e[3]||(e[3]=n("div",{class:"text-subtitle1 text-weight-medium text-grey-8 q-mb-md"}," Export Filter ",-1)),n("div",j,[l(k,{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=a=>s.value=a),options:d.value,label:"Select Month",outlined:"",dense:"",style:{"min-width":"180px"},"emit-value":"","map-options":""},null,8,["modelValue","options"])])]),_:1,__:[3]}),l(B),l(p,{class:"row items-center justify-between q-gutter-md"},{default:r(()=>[n("div",A,[l(D,{label:"Export Data",icon:"download",color:"primary",onClick:v})])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1,__:[4]}))}});export{Y as default};
