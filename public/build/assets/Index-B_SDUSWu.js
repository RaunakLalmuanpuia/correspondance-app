import{Q as U,a as S}from"./QBreadcrumbs-CD6ciBAk.js";import{r as d,c as D,o as E,w as J,a as R,b as T,d as a,e as i,f as s,t as c,i as I,m as b,Q as W,n as z,W as G}from"./app-CFPjTIuC.js";import{Q as H}from"./QSelect-BzXUAIrA.js";import{Q as K,a as u}from"./QTable-CqEdePnh.js";import{Q as X}from"./QChip-CpQjImBF.js";import{a as Z,b as Q,c as N,Q as ee}from"./SFooter.vue_vue_type_style_index_0_scoped_db59b318_lang-Bg5LV2ZQ.js";import{_ as le}from"./BackendLayout-DR8Z9M7A.js";import{d as te}from"./date-DE4bw8OD.js";import{u as ae}from"./use-quasar-B1KT0hSj.js";const se={class:"flex items-center justify-between q-pa-md bg-white"},oe={class:"stitle"},ne={class:"flex q-gutter-sm"},re={class:"break-words whitespace-normal"},ie={class:"whitespace-pre break-words"},ue={class:"whitespace-pre break-words"},ke=Object.assign({layout:le},{__name:"Index",props:["cell","canCreate","canEdit","canDelete"],setup(de){const V=[{name:"s_no",align:"left",label:"S. No",field:"s_no",sortable:!1},{name:"subject",align:"left",label:"Subject",field:"subject",sortable:!1},{name:"letter_no",align:"left",label:"Letter No",field:"letter_no",sortable:!1},{name:"letter_addressee_main",align:"left",label:"Address(Main)",field:"letter_addressee_main",sortable:!1},{name:"letter_addressee_copy_to",align:"left",label:"Address(Copy to)",field:"letter_addressee_copy_to",sortable:!1},{name:"letter_date",align:"left",label:"Letter Date",field:"letter_date",sortable:!0},{name:"designated_cell",align:"left",label:"Designated Cell",field:"designated_cell",sortable:!1},{name:"issue_date",align:"left",label:"Issue Date",field:"issue_date",sortable:!0},{name:"action",align:"left",label:"Action",field:"action",sortable:!1}],g=ae(),$=d([]),f=d(""),h=d(!1),r=d({sortBy:"desc",descending:!1,page:1,rowsPerPage:10,rowsNumber:0}),j=l=>{g.dialog({title:"Confirmation",message:"Do you want to delete?",ok:"Yes",cancel:"No"}).onOk(()=>{G.delete(route("issues.destroy",l.id),{onStart:e=>g.loading.show(),onFinish:e=>g.loading.hide(),preserveState:!1})})},A=l=>{f.value=l,l&&o.value!=="all"&&(o.value="all"),l||(o.value=M.value),_({pagination:r.value,filter:l})};function _(l){const{page:e,rowsPerPage:t,sortBy:n,descending:m}=l.pagination,k=l.filter;h.value=!0,axios.get(route("issues.json-index"),{params:{filter:k,page:e,rowsPerPage:t,month:q.value,year:x.value}}).then(p=>{console.log(p.data);const{list:w}=p.data,{data:y,per_page:O,current_page:F,total:L,to:ce,from:fe}=w;$.value=y,r.value.page=F,r.value.rowsNumber=L,r.value.rowsPerPage=O}).catch(p=>{var w,y;g.notify({type:"negative",message:(y=(w=p==null?void 0:p.response)==null?void 0:w.data)==null?void 0:y.message})}).finally(()=>h.value=!1)}const C=(l,e)=>{try{return l?te.formatDate(new Date(l),"DD-MM-YYYY"):"N/A"}catch{return"Invalid Date"}},B=["January","February","March","April","May","June","July","August","September","October","November","December"],v=d([]);function P(){const l=new Date,e=[];e.push({label:"All",value:"all"});for(let t=0;t<12;t++){const n=new Date(l.getFullYear(),l.getMonth()-t,1),m=n.getFullYear(),k=String(n.getMonth()+1).padStart(2,"0");e.push({label:`${B[n.getMonth()]} ${m}`,value:`${m}-${k}`})}v.value=e}const o=d(null),Y=D(()=>{if(o.value==="all")return"All";if(!o.value)return"";const[l,e]=o.value.split("-");return new Date(Number(l),Number(e)-1,1).toLocaleString("en-US",{month:"long",year:"numeric"})}),q=D(()=>{var e;if(o.value==="all")return null;const l=((e=o.value)==null?void 0:e.split("-"))||[];return Number(l[1]||null)}),x=D(()=>{var e;if(o.value==="all")return null;const l=((e=o.value)==null?void 0:e.split("-"))||[];return Number(l[0]||null)}),M=d(null);return E(()=>{var l,e;P(),M.value=((l=v.value[1])==null?void 0:l.value)||null,o.value=((e=v.value[1])==null?void 0:e.value)||null,_({pagination:r.value,filter:f.value})}),J(o,()=>{_({pagination:r.value,filter:f.value})}),(l,e)=>(T(),R(ee,{class:"container",padding:""},{default:a(()=>[i("div",se,[i("div",null,[i("div",oe,"Issue - "+c(Y.value),1),s(U,{class:"text-dark"},{default:a(()=>[s(S,{class:"cursor-pointer",icon:"dashboard",label:"Dashboard",onClick:e[0]||(e[0]=t=>l.$inertia.get(l.route("dashboard")))}),s(S,{class:"cursor-pointer",label:"Issues",onClick:e[1]||(e[1]=t=>l.$inertia.get(l.route("issues.index")))})]),_:1})]),i("div",ne,[s(I,{onClick:e[2]||(e[2]=t=>l.$inertia.get(l.route("issues.create"))),color:"btn-primary",label:"New Issue"})])]),e[9]||(e[9]=i("br",null,null,-1)),s(K,{flat:"",ref:"tableRef",rows:$.value,columns:V,"row-key":"id",pagination:r.value,"onUpdate:pagination":e[5]||(e[5]=t=>r.value=t),loading:h.value,filter:f.value,"binary-state-sort":"","rows-per-page-options":[5,10,15,30,50],onRequest:_},{"top-left":a(()=>[s(H,{modelValue:o.value,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value=t),options:v.value,label:"Select Month",outlined:"",dense:"",style:{width:"180px"},"emit-value":"","map-options":""},null,8,["modelValue","options"])]),"top-right":a(()=>[s(W,{borderless:"",dense:"",debounce:"800","onUpdate:modelValue":[A,e[4]||(e[4]=t=>f.value=t)],"bg-color":"grey-2",outlined:"",modelValue:f.value,clearable:"",placeholder:"Search"},{append:a(()=>[s(z,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-s_no":a(t=>[s(u,null,{default:a(()=>[b(c(t.row.s_no),1)]),_:2},1024)]),"body-cell-subject":a(t=>[s(u,{style:{"min-width":"200px","max-width":"300px"}},{default:a(()=>[i("div",re,c(t.row.subject),1)]),_:2},1024)]),"body-cell-letter_date":a(t=>[s(u,null,{default:a(()=>[b(c(C(t.row.letter_date)),1)]),_:2},1024)]),"body-cell-letter_addressee_main":a(t=>[s(u,null,{default:a(()=>[i("div",ie,c(t.row.letter_addressee_main),1)]),_:2},1024)]),"body-cell-letter_addressee_copy_to":a(t=>[s(u,null,{default:a(()=>[i("div",ue,c(t.row.letter_addressee_copy_to),1)]),_:2},1024)]),"body-cell-designated_cell":a(t=>[s(u,null,{default:a(()=>{var n,m;return[s(X,{label:(m=(n=t.row)==null?void 0:n.cell)==null?void 0:m.name,square:""},null,8,["label"])]}),_:2},1024)]),"body-cell-issue_date":a(t=>[s(u,null,{default:a(()=>[b(c(C(t.row.issue_date)),1)]),_:2},1024)]),"body-cell-action":a(t=>[s(u,null,{default:a(()=>[s(I,{round:"",icon:"more_vert"},{default:a(()=>[s(Z,null,{default:a(()=>[s(Q,{clickable:"",onClick:n=>l.$inertia.get(l.route("issues.show",t.row.id))},{default:a(()=>[s(N,null,{default:a(()=>e[6]||(e[6]=[b("View Detail")])),_:1,__:[6]})]),_:2},1032,["onClick"]),s(Q,{clickable:"",onClick:n=>l.$inertia.get(l.route("issues.edit",t.row.id))},{default:a(()=>[s(N,null,{default:a(()=>e[7]||(e[7]=[b("Edit")])),_:1,__:[7]})]),_:2},1032,["onClick"]),s(Q,{clickable:"",onClick:n=>j(t.row)},{default:a(()=>[s(N,null,{default:a(()=>e[8]||(e[8]=[b("Delete")])),_:1,__:[8]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1},8,["rows","pagination","loading","filter"])]),_:1,__:[9]}))}});export{ke as default};
