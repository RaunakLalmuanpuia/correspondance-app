import{Q as L,a as M}from"./QBreadcrumbs-CDCeVv2n.js";import{r as i,c as k,o as U,w as E,a as J,b as T,d as a,e as u,f as o,t as p,i as V,m as b,Q as W,n as z,W as G}from"./app-BkvPo1H_.js";import{Q as H}from"./QSelect-DrV8m_ll.js";import{Q as K,a as d}from"./QTable-D7OewuVz.js";import{Q as X}from"./QChip-BFyoZ6Jd.js";import{a as Z,b as Q,c as N,Q as ee}from"./SFooter.vue_vue_type_style_index_0_scoped_db59b318_lang-BwUZBPNG.js";import{_ as te}from"./BackendLayout-Dtqj0282.js";import{u as le}from"./use-quasar-OfiiGGxN.js";import{d as ae}from"./date-BkNKrgoD.js";const oe={class:"flex items-center justify-between q-pa-md bg-white"},ne={class:"stitle"},re={class:"flex q-gutter-sm"},se={class:"break-words whitespace-normal"},ie={class:"whitespace-pre break-words"},he=Object.assign({layout:te},{__name:"Index",props:["canCreate","canEdit","canDelete"],setup(ue){const j=[{name:"s_no",align:"left",label:"S. No",field:"s_no",sortable:!1},{name:"subject",align:"left",label:"Subject",field:"subject",sortable:!1},{name:"letter_no",align:"left",label:"Letter No",field:"letter_no",sortable:!1},{name:"letter_date",align:"left",label:"Letter Date",field:"letter_date",sortable:!0},{name:"received_from",align:"left",label:"Received From",field:"received_from",sortable:!0},{name:"designated_cell",align:"left",label:"Designated Cell",field:"designated_cell",sortable:!0},{name:"name_of_da",align:"left",label:"Name of DA",field:"name_of_da",sortable:!0},{name:"received_date",align:"left",label:"Received Date",field:"received_date",sortable:!0},{name:"action",align:"left",label:"Action",field:"action",sortable:!0}],v=le(),$=i([]),c=i(""),h=i(!1),s=i({sortBy:"desc",descending:!1,page:1,rowsPerPage:10,rowsNumber:0}),B=t=>{v.dialog({title:"Confirmation",message:"Do you want to delete?",ok:"Yes",cancel:"No"}).onOk(()=>{G.delete(route("receipts.destroy",t.id),{onStart:e=>v.loading.show(),onFinish:e=>v.loading.hide(),preserveState:!1})})},R=t=>{c.value=t,t&&n.value!=="all"&&(n.value="all"),t||(n.value=C.value),g({pagination:s.value,filter:t})};function g(t){const{page:e,rowsPerPage:l,sortBy:r,descending:f}=t.pagination,D=t.filter;h.value=!0,axios.get(route("receipts.json-index"),{params:{filter:D,page:e,rowsPerPage:l,month:q.value,year:I.value}}).then(m=>{console.log(m.data);const{list:w}=m.data,{data:y,per_page:x,current_page:F,total:O,to:de,from:ce}=w;$.value=y,s.value.page=F,s.value.rowsNumber=O,s.value.rowsPerPage=x}).catch(m=>{var w,y;v.notify({type:"negative",message:(y=(w=m==null?void 0:m.response)==null?void 0:w.data)==null?void 0:y.message})}).finally(()=>h.value=!1)}const S=(t,e)=>{try{return t?ae.formatDate(new Date(t),"DD-MM-YYYY"):"N/A"}catch{return"Invalid Date"}},A=["January","February","March","April","May","June","July","August","September","October","November","December"],_=i([]);function P(){const t=new Date,e=[];e.push({label:"All",value:"all"});for(let l=0;l<12;l++){const r=new Date(t.getFullYear(),t.getMonth()-l,1),f=r.getFullYear(),D=String(r.getMonth()+1).padStart(2,"0");e.push({label:`${A[r.getMonth()]} ${f}`,value:`${f}-${D}`})}_.value=e}const n=i(null),Y=k(()=>{if(n.value==="all")return"All";if(!n.value)return"";const[t,e]=n.value.split("-");return new Date(Number(t),Number(e)-1,1).toLocaleString("en-US",{month:"long",year:"numeric"})}),q=k(()=>{var e;if(n.value==="all")return null;const t=((e=n.value)==null?void 0:e.split("-"))||[];return Number(t[1]||null)}),I=k(()=>{var e;if(n.value==="all")return null;const t=((e=n.value)==null?void 0:e.split("-"))||[];return Number(t[0]||null)}),C=i(null);return U(()=>{var t,e;P(),C.value=((t=_.value[1])==null?void 0:t.value)||null,n.value=((e=_.value[1])==null?void 0:e.value)||null,g({pagination:s.value,filter:c.value})}),E(n,()=>{g({pagination:s.value,filter:c.value})}),(t,e)=>(T(),J(ee,{class:"container",padding:""},{default:a(()=>[u("div",oe,[u("div",null,[u("div",ne,"Receipts - "+p(Y.value),1),o(L,{class:"text-dark"},{default:a(()=>[o(M,{class:"cursor-pointer",icon:"dashboard",label:"Dashboard",onClick:e[0]||(e[0]=l=>t.$inertia.get(t.route("dashboard")))}),o(M,{class:"cursor-pointer",label:"Receipt",onClick:e[1]||(e[1]=l=>t.$inertia.get(t.route("receipts.index")))})]),_:1})]),u("div",re,[o(V,{onClick:e[2]||(e[2]=l=>t.$inertia.get(t.route("receipts.create"))),color:"btn-primary",label:"New Receipt"})])]),e[9]||(e[9]=u("br",null,null,-1)),o(K,{flat:"",ref:"tableRef",rows:$.value,columns:j,"row-key":"id",pagination:s.value,"onUpdate:pagination":e[5]||(e[5]=l=>s.value=l),loading:h.value,filter:c.value,"binary-state-sort":"","rows-per-page-options":[5,10,15,30,50],onRequest:g},{"top-left":a(()=>[o(H,{modelValue:n.value,"onUpdate:modelValue":e[3]||(e[3]=l=>n.value=l),options:_.value,label:"Select Month",outlined:"",dense:"",style:{width:"180px"},"emit-value":"","map-options":""},null,8,["modelValue","options"])]),"top-right":a(()=>[o(W,{borderless:"",dense:"",debounce:"800","onUpdate:modelValue":[R,e[4]||(e[4]=l=>c.value=l)],"bg-color":"grey-2",outlined:"",modelValue:c.value,clearable:"",placeholder:"Search"},{append:a(()=>[o(z,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-s_no":a(l=>[o(d,null,{default:a(()=>[b(p(l.row.s_no),1)]),_:2},1024)]),"body-cell-subject":a(l=>[o(d,{style:{"min-width":"300px","max-width":"400px"}},{default:a(()=>[u("div",se,p(l.row.subject),1)]),_:2},1024)]),"body-cell-letter_date":a(l=>[o(d,null,{default:a(()=>[b(p(S(l.row.letter_date)),1)]),_:2},1024)]),"body-cell-received_from":a(l=>[o(d,null,{default:a(()=>[u("div",ie,p(l.row.received_from),1)]),_:2},1024)]),"body-cell-designated_cell":a(l=>[o(d,null,{default:a(()=>{var r,f;return[o(X,{label:(f=(r=l.row)==null?void 0:r.cell)==null?void 0:f.name,square:""},null,8,["label"])]}),_:2},1024)]),"body-cell-received_date":a(l=>[o(d,null,{default:a(()=>[b(p(S(l.row.received_date)),1)]),_:2},1024)]),"body-cell-action":a(l=>[o(d,null,{default:a(()=>[o(V,{round:"",icon:"more_vert"},{default:a(()=>[o(Z,null,{default:a(()=>[o(Q,{clickable:"",onClick:r=>t.$inertia.get(t.route("receipts.show",l.row.id))},{default:a(()=>[o(N,null,{default:a(()=>e[6]||(e[6]=[b("View Detail")])),_:1,__:[6]})]),_:2},1032,["onClick"]),o(Q,{clickable:"",onClick:r=>t.$inertia.get(t.route("receipts.edit",l.row.id))},{default:a(()=>[o(N,null,{default:a(()=>e[7]||(e[7]=[b("Edit")])),_:1,__:[7]})]),_:2},1032,["onClick"]),o(Q,{clickable:"",onClick:r=>B(l.row)},{default:a(()=>[o(N,null,{default:a(()=>e[8]||(e[8]=[b("Delete")])),_:1,__:[8]})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1},8,["rows","pagination","loading","filter"])]),_:1,__:[9]}))}});export{he as default};
