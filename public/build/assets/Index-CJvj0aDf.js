import{Q as K,a as F}from"./QBreadcrumbs-Cc0n6QiA.js";import{r as u,c as M,o as X,w as Z,a as w,b as h,d as t,e as s,f as o,t as i,m as V,i as j,n as p,Q as ee,p as le,q as te,j as ae,k as I,W as oe}from"./app-DsiMy1nO.js";import{Q as se}from"./QSelect-BexRWrLA.js";import{Q as ne,a as f}from"./QTable-Do7_DI4b.js";import{Q as ie}from"./QChip-BUfnKTgb.js";import{a as re,b as R,c as q,Q as de}from"./SFooter.vue_vue_type_style_index_0_scoped_db59b318_lang-B9to8UDw.js";import{Q as m}from"./QField-BHCu9AsH.js";import{_ as ue}from"./BackendLayout-CMp9Dp6j.js";import{u as ce}from"./use-quasar-CAprR2Q7.js";import{d as fe}from"./date-B_LMKYWU.js";const me={class:"flex items-center justify-between q-pa-md bg-white"},be={class:"stitle"},ve={class:"flex q-gutter-sm"},_e={class:"break-words whitespace-normal"},pe={class:"whitespace-pre break-words"},ge={class:"stitle"},we={class:"row q-col-gutter-sm",style:{"max-width":"720px"}},he={class:"col-xs-12"},ye={class:"subtitle whitespace-pre-line"},ke={class:"col-xs-12"},De={class:"subtitle whitespace-pre-line"},Qe={class:"col-xs-12 col-sm-6"},Ce={class:"subtitle"},Ne={class:"col-xs-12 col-sm-6"},Se={class:"subtitle"},Ve={class:"col-xs-12 col-sm-6"},xe={class:"subtitle"},$e={class:"col-xs-12 col-sm-6"},Me={class:"subtitle"},je={class:"col-xs-12 col-sm-6"},Re={class:"subtitle"},Te=Object.assign({layout:ue},{__name:"Index",props:["canView","canCreate","canEdit","canDelete"],setup(y){const P=[{name:"s_no",align:"left",label:"S. No",field:"s_no",sortable:!1},{name:"subject",align:"left",label:"Subject",field:"subject",sortable:!1},{name:"letter_no",align:"left",label:"Letter No",field:"letter_no",sortable:!1},{name:"letter_date",align:"left",label:"Letter Date",field:"letter_date",sortable:!0},{name:"received_from",align:"left",label:"Received From",field:"received_from",sortable:!0},{name:"designated_cell",align:"left",label:"Designated Cell",field:"designated_cell",sortable:!0},{name:"name_of_da",align:"left",label:"Name of DA",field:"name_of_da",sortable:!0},{name:"received_date",align:"left",label:"Received Date",field:"received_date",sortable:!0},{name:"action",align:"left",label:"Action",field:"action",sortable:!0}],k=ce(),A=u([]),b=u(""),x=u(!1),c=u({sortBy:"desc",descending:!1,page:1,rowsPerPage:10,rowsNumber:0}),D=u(!1),d=u({}),Y=a=>{d.value=a,D.value=!0},L=a=>{k.dialog({title:"Confirmation",message:"Do you want to delete?",ok:"Yes",cancel:"No"}).onOk(()=>{oe.delete(route("receipts.destroy",a.id),{onStart:e=>k.loading.show(),onFinish:e=>k.loading.hide(),preserveState:!1})})},O=a=>{b.value=a,a&&n.value!=="all"&&(n.value="all"),a||(n.value=B.value),Q({pagination:c.value,filter:a})};function Q(a){const{page:e,rowsPerPage:l,sortBy:r,descending:v}=a.pagination,$=a.filter;x.value=!0,axios.get(route("receipts.json-index"),{params:{filter:$,page:e,rowsPerPage:l,month:T.value,year:W.value}}).then(_=>{console.log(_.data);const{list:N}=_.data,{data:S,per_page:z,current_page:G,total:H,to:qe,from:Ae}=N;A.value=S,c.value.page=G,c.value.rowsNumber=H,c.value.rowsPerPage=z}).catch(_=>{var N,S;k.notify({type:"negative",message:(S=(N=_==null?void 0:_.response)==null?void 0:N.data)==null?void 0:S.message})}).finally(()=>x.value=!1)}const g=(a,e)=>{try{return a?fe.formatDate(new Date(a),"DD-MM-YYYY"):"N/A"}catch{return"Invalid Date"}},U=["January","February","March","April","May","June","July","August","September","October","November","December"],C=u([]);function E(){const a=new Date,e=[];e.push({label:"All",value:"all"});for(let l=0;l<12;l++){const r=new Date(a.getFullYear(),a.getMonth()-l,1),v=r.getFullYear(),$=String(r.getMonth()+1).padStart(2,"0");e.push({label:`${U[r.getMonth()]} ${v}`,value:`${v}-${$}`})}C.value=e}const n=u(null),J=M(()=>{if(n.value==="all")return"All";if(!n.value)return"";const[a,e]=n.value.split("-");return new Date(Number(a),Number(e)-1,1).toLocaleString("en-US",{month:"long",year:"numeric"})}),T=M(()=>{var e;if(n.value==="all")return null;const a=((e=n.value)==null?void 0:e.split("-"))||[];return Number(a[1]||null)}),W=M(()=>{var e;if(n.value==="all")return null;const a=((e=n.value)==null?void 0:e.split("-"))||[];return Number(a[0]||null)}),B=u(null);return X(()=>{var a,e;E(),B.value=((a=C.value[1])==null?void 0:a.value)||null,n.value=((e=C.value[1])==null?void 0:e.value)||null,Q({pagination:c.value,filter:b.value})}),Z(n,()=>{Q({pagination:c.value,filter:b.value})}),(a,e)=>(h(),w(de,{class:"container",padding:""},{default:t(()=>[s("div",me,[s("div",null,[s("div",be,"Receipts - "+i(J.value),1),o(K,{class:"text-dark"},{default:t(()=>[o(F,{class:"cursor-pointer",icon:"dashboard",label:"Dashboard",onClick:e[0]||(e[0]=l=>a.$inertia.get(a.route("dashboard")))}),o(F,{class:"cursor-pointer",label:"Receipt",onClick:e[1]||(e[1]=l=>a.$inertia.get(a.route("receipts.index")))})]),_:1})]),s("div",ve,[y.canCreate?(h(),w(j,{key:0,onClick:e[2]||(e[2]=l=>a.$inertia.get(a.route("receipts.create"))),color:"btn-primary",label:"New Receipt"})):V("",!0)])]),e[11]||(e[11]=s("br",null,null,-1)),o(ne,{flat:"",ref:"tableRef",rows:A.value,columns:P,"row-key":"id",pagination:c.value,"onUpdate:pagination":e[5]||(e[5]=l=>c.value=l),loading:x.value,filter:b.value,"binary-state-sort":"","rows-per-page-options":[5,10,15,30,50],onRequest:Q},{"top-left":t(()=>[o(se,{modelValue:n.value,"onUpdate:modelValue":e[3]||(e[3]=l=>n.value=l),options:C.value,label:"Select Month",outlined:"",dense:"",style:{width:"180px"},"emit-value":"","map-options":""},null,8,["modelValue","options"])]),"top-right":t(()=>[o(ee,{borderless:"",dense:"",debounce:"800","onUpdate:modelValue":[O,e[4]||(e[4]=l=>b.value=l)],"bg-color":"grey-2",outlined:"",modelValue:b.value,clearable:"",placeholder:"Search"},{append:t(()=>[o(le,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-s_no":t(l=>[o(f,null,{default:t(()=>[p(i(l.row.s_no),1)]),_:2},1024)]),"body-cell-subject":t(l=>[o(f,{style:{"min-width":"300px","max-width":"400px"}},{default:t(()=>[s("div",_e,i(l.row.subject),1)]),_:2},1024)]),"body-cell-letter_date":t(l=>[o(f,null,{default:t(()=>[p(i(g(l.row.letter_date)),1)]),_:2},1024)]),"body-cell-received_from":t(l=>[o(f,null,{default:t(()=>[s("div",pe,i(l.row.received_from),1)]),_:2},1024)]),"body-cell-designated_cell":t(l=>[o(f,null,{default:t(()=>{var r,v;return[o(ie,{label:(v=(r=l.row)==null?void 0:r.cell)==null?void 0:v.name,square:""},null,8,["label"])]}),_:2},1024)]),"body-cell-received_date":t(l=>[o(f,null,{default:t(()=>[p(i(g(l.row.received_date)),1)]),_:2},1024)]),"body-cell-action":t(l=>[o(f,null,{default:t(()=>[o(j,{round:"",icon:"more_vert"},{default:t(()=>[o(re,null,{default:t(()=>[y.canView?(h(),w(R,{key:0,clickable:"",onClick:r=>Y(l.row)},{default:t(()=>[o(q,null,{default:t(()=>e[8]||(e[8]=[p("View Detail")])),_:1,__:[8]})]),_:2},1032,["onClick"])):V("",!0),y.canEdit?(h(),w(R,{key:1,clickable:"",onClick:r=>a.$inertia.get(a.route("receipts.edit",l.row.id))},{default:t(()=>[o(q,null,{default:t(()=>e[9]||(e[9]=[p("Edit")])),_:1,__:[9]})]),_:2},1032,["onClick"])):V("",!0),y.canDelete?(h(),w(R,{key:2,clickable:"",onClick:r=>L(l.row)},{default:t(()=>[o(q,null,{default:t(()=>e[10]||(e[10]=[p("Delete")])),_:1,__:[10]})]),_:2},1032,["onClick"])):V("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:1},8,["rows","pagination","loading","filter"]),o(te,{modelValue:D.value,"onUpdate:modelValue":e[7]||(e[7]=l=>D.value=l),"transition-show":"slide-up","transition-hide":"slide-down"},{default:t(()=>[o(ae,null,{default:t(()=>[o(I,{class:"row items-center justify-between"},{default:t(()=>[s("div",ge,"Receipt - "+i(d.value.s_no),1),o(j,{dense:"",flat:"",icon:"close",onClick:e[6]||(e[6]=l=>D.value=!1)})]),_:1}),o(I,null,{default:t(()=>[s("div",we,[s("div",he,[o(m,{label:"Subject",outlined:"","stack-label":"","bg-color":"white"},{default:t(()=>[s("div",ye,i(d.value.subject||"—"),1)]),_:1})]),s("div",ke,[o(m,{label:"Received From",outlined:"","stack-label":"","bg-color":"white"},{default:t(()=>[s("div",De,i(d.value.received_from||"—"),1)]),_:1})]),s("div",Qe,[o(m,{label:"Letter No",outlined:"","stack-label":"","bg-color":"white"},{default:t(()=>[s("div",Ce,i(d.value.letter_no||"—"),1)]),_:1})]),s("div",Ne,[o(m,{label:"Letter Date",outlined:"","stack-label":"","bg-color":"white"},{default:t(()=>[s("div",Se,i(g(d.value.letter_date)),1)]),_:1})]),s("div",Ve,[o(m,{label:"Designated Cell",outlined:"","stack-label":"","bg-color":"white"},{default:t(()=>{var l,r;return[s("div",xe,i(((r=(l=d.value)==null?void 0:l.cell)==null?void 0:r.name)||"—"),1)]}),_:1})]),s("div",$e,[o(m,{label:"Name of DA",outlined:"","stack-label":"","bg-color":"white"},{default:t(()=>[s("div",Me,i(g(d.value.name_of_da)||"—"),1)]),_:1})]),s("div",je,[o(m,{label:"Issue Date",outlined:"","stack-label":"","bg-color":"white"},{default:t(()=>[s("div",Re,i(g(d.value.received_date)||"—"),1)]),_:1})])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1,__:[11]}))}});export{Te as default};
